function initPart0(){var e,t,n,r,o,a,i,l,s,c,p,f,d,w;return e=$("#banner"),t=$("#banner .mid:first"),n=t.next(),$("#instructions").css("opacity","0"),TweenMax.to($("#instructions-hint"),2,{y:"10",yoyo:!0,repeat:-1}),$("#startBtn").mousedown(function(){$(this).addClass("clicked")}).bind("mouseup ",function(){$(this).removeClass("clicked"),window.scrollTo(0,200),TweenLite.to($("#startBtn"),.5,{opacity:"0"})}),TweenLite.set(e,{transformPerspective:500}),r=TweenLite.from(e,.5,{rotationX:85,y:0,opacity:"0"}),o=TweenMax.staggerFrom([t,n],1.5,{opacity:"0",delay:2},1.5),a=TweenLite.from($("#part0-mosn,#part0-mosr,#part0-wing"),3,{delay:3,y:-vert,x:hori,ease:RoughEase.ease.config({points:9,template:Elastic.easeIn,taper:"in",clamp:!0})}),i=TweenLite.to($("#part0-mosn"),6,{clip:"rect(0px, 230px, 200px, 230px);",ease:Linear.easeNone}),d=new ScrollMagic,l=new ScrollScene({duration:1}).setPin("#trigger1"),l.on("enter leave",function(){TweenLite.to($("#startBtn"),2,{opacity:"1"})}),s=new ScrollScene({offset:"200",duration:0}).setTween(r),c=new ScrollScene({offset:"200",duration:0}).setTween(o),p=new ScrollScene({offset:"200",duration:0}).setTween(a),f=new ScrollScene({offset:"210",duration:600}).setTween(i),s.on("end",function(){TweenLite.to($("#startBtn"),.1,{opacity:"0"}),$("#instructions").removeAttr("style"),TweenLite.from($("#instructions"),2,{opacity:"0",top:vert,delay:4}),TweenMax.to($("#instructions"),1,{y:"10",yoyo:!0,repeat:-1})}),d.addScene([l,s,c,p,f]),wingFlap(),loopClouds(),l}function loopClouds(){var e=$("#clouds1"),t=$("#clouds2");TweenMax.to(t,60,{left:vert,repeat:-1,yoyo:!0,ease:Linear.easeNone}),TweenMax.to(e,50,{css:{left:vert},repeat:-1,yoyo:!0,ease:Linear.easeNone})}function wingFlap(){var e=$("#part0-wing");e.css("opacity","1"),TweenMax.to($("#part0-wing"),.1,{opacity:"0",repeat:2,delay:rand(3,5),onComplete:wingFlap})}function initPart1(){var e,t,n,r,o,a,i,l,s,c;t=$("#part1-text1"),n=$("#part1-text2"),r=$("#part1-text3"),o=TweenLite.from(t,1,{opacity:"0",y:"20"}),a=TweenLite.from(n,1,{opacity:"0",y:"20"}),i=TweenLite.from(r,1,{opacity:"0",y:"20"}),l=new ScrollScene({triggerElement:"#trigger1",offset:vert/2,duration:0}).setTween(o),s=new ScrollScene({triggerElement:"#trigger1",offset:vert/2+200,duration:0}).setTween(a),c=new ScrollScene({triggerElement:"#trigger1",offset:vert/2+500,duration:0}).setTween(i);var p=new ScrollMagic;return p.addScene([l,s,c]),bloodFlow1(),bloodFlow2(),p}function bloodFlow1(){var e=$("#part1-blood");e.css("left",hori.toString()+"px"),TweenLite.from(e,10,{left:"-400px",ease:Linear.easeNone,onComplete:bloodFlow1})}function bloodFlow2(){var e=$("#part1-bloodinf");e.css("left",hori.toString()+"px"),TweenLite.from(e,15,{left:"-200px",onComplete:bloodFlow2,ease:Linear.easeNone})}function plasmodium(){var e=$("#part1-particles"),t=e.children(),n=e.height(),r=e.width(),o=$("#part1-flowL"),a=$("#part1-flowR");e.removeAttr("style"),$("img.germs").removeAttr("style"),$(".flow").removeAttr("style"),TweenLite.to($(".flow"),1,{opacity:"1"});for(var i=TweenLite.from(o,1,{top:"-200px",left:"-50px",ease:Linear.easeNone}),l=TweenLite.from(a,1,{top:"-200px",right:"-50px",ease:Linear.easeNone}),s=0;s<t.length;s++)TweenLite.to(t[s],4,{left:rand(0-2*r,2*r),top:rand(n,3*n),rotation:rand(-180,180),delay:.8}),0;TweenLite.to($(".germs"),15,{left:vert+200+"px",ease:Linear.easeNone,delay:1.8,opacity:"1"}),fixMaps()}function fixMaps(){$("#part2-world-map").resize(),$("#part2-world-map-cases").resize(),$("#part4-world-map").resize()}function rand(e,t){return Math.floor(Math.random()*(1+t-e)+e)}function initPart2(){function e(){n.css("display","none"),r.css("opacity","1")}var t,n,r,o,a,i,l,s,c,p,f,d,w,g,m,S,u,T,y;makePart2Map(),makePart2MapCases(),n=$("#part2-world-map"),r=$("#part2-world-map-cases"),s=$("#part2-emph1 span"),c=$("#part2-emph2 span"),a=$("#part2-emph1"),i=$("#part2-top-info p"),l=$("#part2-emph2"),o=$("#part2-text2"),p=TweenLite.from(a,1,{opacity:"0",y:"20",onStart:countUp,onStartParams:[97,s,2e3,0]}),f=TweenLite.from(i,1,{opacity:"0",y:"20",delay:2}),d=TweenLite.from(l,1,{opacity:"0",y:"20",onStart:countUp,onStartParams:[90,c,2e3,1]}),w=TweenLite.from(o,1,{opacity:"0",y:"20"}),g=TweenLite.to(n,.1,{opacity:"0",onComplete:e,delay:2.5}),S=new ScrollScene({triggerElement:"#trigger2",offset:vert/2,duration:0}).setTween(p),u=new ScrollScene({triggerElement:"#trigger2",offset:vert/2,duration:0}).setTween(f),T=new ScrollScene({triggerElement:"#trigger2",offset:vert/2+500,duration:0}).setTween(d),m=new ScrollScene({triggerElement:"#trigger2",offset:vert/2+500,duration:0}).setTween(g),y=new ScrollScene({triggerElement:"#trigger2",offset:vert/2+700,duration:0}).setTween(w);var M=new ScrollMagic;M.addScene([S,u,T,m,y]),m.on("start",function(e){n.removeAttr("style"),r.removeAttr("style")}),fixMaps()}function makePart2Map(){$("#part2-world-map").vectorMap({map:"world_mill_en",backgroundColor:"transparent",zoomOnScroll:!1,regionStyle:{initial:{fill:"#4c4c4c"},hover:{fill:"#fba309"},selected:{fill:"#fba309"},selectedHover:{}},series:{regions:[{values:casesData,scale:["#9a0001","#9a0000"],normalizeFunction:"polynomial"}]},onRegionLabelShow:function(e,t,n){t.html(t.html())}}),$("#part2-world-map").append("<p>Data retrieved from the WHO 2013 World Malaria Report</p>"),$("#part2-mapTitle").text("Countries Affected by Malaria")}function makePart2MapCases(){$("#part2-world-map-cases").vectorMap({map:"world_mill_en",backgroundColor:"transparent",zoomOnScroll:!1,regionStyle:{initial:{fill:"#4c4c4c"},hover:{fill:"#fba309"},selected:{fill:"#fba309"},selectedHover:{}},series:{regions:[{values:casesData,scale:["#ffffff","#9a0000"],normalizeFunction:"polynomial"}]},onRegionLabelShow:function(e,t,n){t.html(t.html()+"<br/>Cases: "+formatNumber(casesData[n]))}})}function countUp(e,t,n,r){var o="";$({countNum:0}).animate({countNum:e},{duration:n,easing:"linear",step:function(){1===r&&(o="%"),t.text(Math.floor(this.countNum)+o)},complete:function(){t.text(this.countNum+o)}})}function initPart3(){var e,t,n,r,o,a,i,l,s,c,p,f,d,w,g,m;t=$("#part3-ITN"),n=$("#part3-IRS"),r=$("#part3-antiMed"),o=$("#part3-other"),a=$("#net"),i=$("#part3-mininet"),l=$("#part3-bed"),s=$("#part3-spraycan"),c=$("#part3-spraycloud"),g=TweenLite.to($("#part3-top"),2,{css:{backgroundColor:"#32394f"},ease:Linear.easeNone,delay:0}),m=TweenLite.to($("#part3"),2,{css:{backgroundColor:"#232439"},ease:Linear.easeNone,delay:0}),nightTween3=TweenLite.from($("#net"),2,{css:{backgroundColor:"rgba(112,112,112,0.46)"},ease:Linear.easeNone,delay:0}),d=TweenLite.to($("#net"),5,{"background-position-y":"-1300px",ease:Linear.easeNone}),w=TweenLite.to($("#net"),2,{opacity:"0"}),tween1=TweenLite.from(t,1,{opacity:"0",y:"20"}),tween2=TweenLite.from(n,1,{opacity:"0",y:"20"}),tween3=TweenLite.from(r,1,{opacity:"0",y:"20"}),tween4=TweenLite.from(o,1,{opacity:"0",y:"20"}),tweenMiniNet=TweenLite.from(i,3,{scaleY:.1,y:-300,opacity:"0",ease:Linear.easeNone}),tweenSprayCan=TweenLite.from(s,2,{y:20}),tweenSprayCloud=TweenMax.from(c,.5,{scaleY:.1,scaleX:.1,x:-25,y:-70,opacity:"0",ease:Linear.easeNone,delay:1,repeat:3}),scene1=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+150,duration:200}).setTween(g),scene2=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+150,duration:200}).setTween(m),scene2b=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+150,duration:200}).setTween(nightTween3),scene3=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+500,duration:800}).setTween(d),scene4=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+1e3,duration:300}).setTween(w),scene5=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+1400,duration:0}).setTween(tween1),scene6=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+1650,duration:250}).setTween(tweenMiniNet),scene7=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+2e3,duration:0}).setTween(tween2),scene8=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+2150,duration:50}).setTween(tweenSprayCan),scene9=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+2200,duration:100}).setTween(tweenSprayCloud),scene10=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+2400,duration:0}).setTween(tween3),controller=new ScrollMagic,controller.addScene([scene1,scene2,scene2b,scene3,scene4,scene5,scene6,scene7,scene8,scene9,scene10])}function initPart4(){makePart4Map();var e,t,n,r,o,a,i,r,l,s,c,p,f,d,w,g,m,S;controller=new ScrollMagic}function makePart4Map(){$("#part4-world-map").vectorMap({map:"world_mill_en",backgroundColor:"transparent",zoomOnScroll:!1,regionsSelectable:!0,regionsSelectableOne:!0,regionStyle:{initial:{fill:"#4c4c4c"},hover:{fill:"#fba309"},selected:{fill:"#fba309"},selectedHover:{}},series:{regions:[{values:casesData,scale:["#ffffff","#9a0000"],normalizeFunction:"polynomial"}]},onRegionLabelShow:function(e,t,n){t.html(t.html()+"<br/>Cases: "+formatNumber(casesData[n]))},onRegionSelected:function(e,t,n,r){var o=$("#part4-world-map").vectorMap("get","mapObject").getRegionName(t);null!=plot1?(plot1.destroy(),checkValidData(t)&&(plot1=makeBarGraph(itnData2012[t],irsData2012[t],antiMal2012[t],o))):checkValidData(t)&&(plot1=makeBarGraph(itnData2012[t],irsData2012[t],antiMal2012[t],o))}}),$("#part4-world-map").append("<p>Data retrieved from the WHO 2013 World Malaria Report</p>")}function formatNumber(e){e+="",x=e.split("."),x1=x[0],x2=x.length>1?"."+x[1]:"";for(var t=/(\d+)(\d{3})/;t.test(x1);)x1=x1.replace(t,"$1,$2");return x1+x2}function checkValidData(e){return"undefined"==typeof itnData2012[e]||"undefined"==typeof irsData2012[e]||"undefined"==typeof antiMal2012[e]?!1:!0}function makeBarGraph(e,t,n,r){var o,a,i;if(o=[e],a=[t],i=[n],-1==e){o=[" "];var l="(No Information Provided)"}else l=o+"%";if(-1==t){a=[" "];var s="(No Information Provided)"}else s=a+"%";if(0==n){i=[" "];var c="(No Information Provided)"}else c=i+"%";var p=[e,t,n],f=jQuery.jqplot("chart1",[p],{title:r+"'s Estimated Intervention/Prevention Coverage",seriesDefaults:{renderer:$.jqplot.BarRenderer,rendererOptions:{barPadding:8,barMargin:10,barDirection:"vertical",barWidth:50,shadowOffset:2,shadowDepth:5,shadowAlpha:.8}},series:[{pointLabels:{show:!0,labels:[l,s,c]}}],axesDefaults:{min:0,max:120},axes:{xaxis:{renderer:$.jqplot.CategoryAxisRenderer,ticks:[["Insectide Treated Nets"],["Indoor Residual Spraying"],["Antimalarial Coverage"]]},yaxis:{label:"% of population potentially protected",pad:1.05,labelOptions:{fontSize:"8pt"}}}});return f}function makePieGraph(e,t,n){var r,o,a,i,l,s;r=e,o=100-e,a=t,i=100-t,l=n,s=100-n;var c=[["Population potentially protected by ITNs",r],["Unprotected",o]],p=[["% IRS Coverage",a],["Unprotected",i]],f=[["AntiMalarial coverage",l],["Unprotected",s]],d=$.jqplot("chart1",[c,p,f],{seriesDefaults:{renderer:$.jqplot.DonutRenderer,rendererOptions:{sliceMargin:1,startAngle:-90,showDataLabels:!0}},legend:{show:!0,location:"e"}});return d}function initPart5(){var e=new Date;setInterval(function(){var t=Math.round((new Date-e)/1e3),n=Math.round(t/60/60),r=Math.floor(t/60%60),o=Math.floor(t%60%60);10>o&&(o="0"+o),n>0&&(n+=":"),$("#timer>h2").text(n+r+":"+o)},1e3)}var antiMal2012,itnData2012,irsData2012,casesData;antiMal2012={DZ:100,AO:99,BJ:0,BW:100,BF:100,BI:100,CV:70,CM:21,CF:0,TD:0,KM:0,CG:14,CI:0,CD:68,GQ:22,ER:100,ET:100,GA:0,GM:93,GH:60,GN:21,GW:0,KE:100,LR:100,MG:100,MW:100,ML:100,MR:0,MZ:72,NA:100,NE:74,NG:27,RW:95,ST:100,SN:19,SL:100,ZA:57,SZ:47,TG:52,UG:100,TZ:100,ZM:100,ZW:100,AR:100,BZ:100,BO:100,BR:100,CO:100,CR:100,DO:99,EC:100,SV:100,GF:0,GT:100,GY:100,HT:100,HN:100,MX:100,NI:100,PA:100,PY:100,PE:0,SR:0,VE:0,AF:0,DJ:0,IR:100,IQ:0,PK:65,SA:100,SO:3,SS:100,SD:65,YE:70,AZ:100,GE:0,KG:100,TJ:100,TR:100,UZ:100,BD:100,BT:100,KP:100,IN:100,ID:13,MM:78,NP:100,LK:100,TH:100,TL:100,KH:100,CN:0,LA:100,MY:100,PG:0,PH:100,KR:71,SB:100,VU:99,VN:100},itnData2012={DZ:-1,AO:34,BJ:100,BW:21,BF:87,BI:100,CV:-1,CM:71,CF:39,TD:56,KM:68,CG:71,CI:75,CD:90,GQ:2,ER:35,ET:71,GA:-1,GM:100,GH:93,GN:3,GW:34,KE:79,LR:74,MG:76,MW:100,ML:86,MR:54,MZ:53,NA:30,NE:19,NG:54,RW:100,ST:100,SN:44,SL:100,ZA:-1,SZ:83,TG:84,UG:45,TZ:94,ZM:94,ZW:46,AR:-1,BZ:0,BO:39,BR:18,CO:16,CR:49,DO:88,EC:87,SV:-1,GF:-1,GT:50,GY:28,HT:100,HN:7,MX:100,NI:100,PA:-1,PY:-1,PE:-1,SR:32,VE:3,AF:98,DJ:23,IR:17,IQ:0,PK:2,SA:46,SO:20,SS:60,SD:22,YE:31,AZ:18,GE:0,KG:100,TJ:100,TR:-1,UZ:100,BD:89,BT:100,KP:43,IN:6,ID:26,MM:35,NP:100,LK:53,TH:23,TL:45,KH:100,CN:100,LA:84,MY:100,PG:86,PH:100,KR:1,SB:100,VU:100,VN:18},irsData2012={DZ:0,AO:3,BJ:7,BW:13,BF:1,BI:1,CV:100,CM:0,CF:0,TD:-1,KM:-1,CG:0,CI:-1,CD:0,GQ:20,ER:5,ET:9,GA:-1,GM:27,GH:8,GN:-1,GW:-1,KE:7,LR:23,MG:24,MW:12,ML:5,MR:-1,MZ:7,NA:34,NE:1,NG:1,RW:9,ST:78,SN:8,SL:17,ZA:95,SZ:-1,TG:0,UG:7,TZ:-1,ZM:31,ZW:48,AR:13,BZ:9,BO:6,BR:8,CO:5,CR:46,DO:14,EC:36,SV:1,GF:-1,GT:3,GY:7,HT:0,HN:7,MX:12,NI:100,PA:13,PY:17,PE:-1,SR:-1,VE:100,AF:0,DJ:-1,IR:11,IQ:-1,PK:9,SA:60,SO:3,SS:2,SD:13,YE:18,AZ:99,GE:-1,KG:100,TJ:100,TR:0,UZ:100,BD:0,BT:100,KP:55,IN:18,ID:0,MM:0,NP:44,LK:2,TH:8,TL:19,KH:0,CN:100,LA:0,MY:56,PG:-1,PH:22,KR:-1,SB:24,VU:4,VN:9},casesData={DZ:90,AO:38e5,BJ:29e5,BW:600,BF:56e5,BI:84e4,CV:3110,CM:37e5,CF:16e5,TD:33e5,KM:16e4,CG:15e5,CI:41e5,CD:17e6,GQ:18e4,ER:79e3,ET:42e5,GA:41e4,GM:52e4,GH:69e5,GN:44e5,GW:47e4,KE:35e5,LR:12e5,MG:13e5,MW:44e5,ML:3e6,MR:67e4,MZ:7e6,NA:520,NE:48e5,NG:48e6,RW:65e4,ST:23e3,SN:38e5,SL:11e5,ZA:17e3,SZ:530,TG:16e5,UG:89e5,TZ:83e5,ZM:37e5,ZW:11e5,AR:5,BZ:40,BO:11e3,BR:31e4,CO:97e3,CR:8,DO:1300,EC:640,SV:20,GF:1500,GT:8700,GY:63e3,HT:13e4,HN:13e3,MX:1e3,NI:2300,PA:1e3,PY:0,PE:57e3,SR:420,VE:86e3,AF:38e4,DJ:21e3,IR:930,IQ:0,PK:35e5,SA:100,SO:65e4,SS:232e5,SD:5e6,YE:43e4,AZ:4,GE:1,KG:0,TJ:20,TR:0,UZ:0,BD:61e4,BT:150,KP:26e3,IN:19e6,ID:56e5,MM:14e5,NP:17e3,LK:80,TH:14e4,TL:93e3,KH:16e4,CN:6800,LA:11e4,MY:9800,PG:1e6,PH:23e3,KR:1310,SB:39e3,VU:9300,VN:27e3};var hori=$(window).width(),vert=$(window).height();$(window).load(function(){$("#loader").fadeOut("slow"),$(".part").height(vert)}),$(document).ready(function(){function e(e){var t=$("#instructions-hint");t.removeAttr("style"),setTimeout(function(){e===$(window).scrollTop()&&800<$(window).scrollTop()&&TweenLite.to($("#instructions-hint"),1,{opacity:"1",bottom:"5px"},Linear.easeNone)},5e3)}function t(){pin0=new ScrollScene({duration:800}).setPin("#part0"),r.addScene(pin0),pin1=new ScrollScene({triggerElement:"#trigger1",offset:vert/2,duration:1e3}).setPin("#part1"),pin1.addIndicators(),pin1.on("start",function(){plasmodium()}),pin1.on("exit",function(){$(".germs").removeAttr("style")}),r.addScene(pin1),pin2=new ScrollScene({triggerElement:"#trigger2",offset:vert/2,duration:1700}).setPin("#part2"),r.addScene(pin2),pin3=new ScrollScene({triggerElement:"#trigger3",offset:vert/2,duration:3e3}).setPin("#part3"),r.addScene(pin3),pin4=new ScrollScene({triggerElement:"#trigger4",offset:vert/2,duration:500}).setPin("#part4"),r.addScene(pin4)}function n(){for(i=0;i<control.length;i++)control[0].removeScene("pin");t()}$(window).scroll(function(){$(window).scrollTop()+$(window).height()!==$(document).height()&&(window.scroll=$(window).scrollTop(),e(window.scroll))});var r=new ScrollMagic;t(),initPart0(),initPart1(),initPart2(),initPart3(),initPart4(),initPart5()});var plot1=null;