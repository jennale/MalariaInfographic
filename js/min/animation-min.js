function initPart0(){var e,t,n,r,o,a,i,l,s,c,p,f,d,w;e=$("#banner"),r=$("#banner .mid:first"),o=r.next(),$("#instructions").css("opacity","0"),TweenMax.to($("#instructions-hint"),1,{y:"10",yoyo:!0,repeat:-1}),$("#startBtn").mousedown(function(){$(this).addClass("clicked")}).bind("mouseup ",function(){$(this).removeClass("clicked"),scrollTo(0,200),TweenLite.to($("#startBtn"),.5,{opacity:"0"})}),TweenLite.set(e,{transformPerspective:500}),a=TweenLite.from(e,1.5,{rotationX:90,y:-50,opacity:"0"}),i=TweenMax.staggerFrom([r,o],1.5,{opacity:"0",delay:2},1.5),l=TweenLite.from($("#part0-mosn,#part0-mosr,#part0-wing"),3,{delay:3,y:-vert,x:hori,ease:RoughEase.ease.config({points:9,template:Elastic.easeIn,taper:"in",clamp:!0})}),tween4=TweenLite.to($("#part0-mosn"),6,{clip:"rect(0px, 230px, 200px, 230px);",ease:Linear.easeNone}),w=new ScrollMagic,s=new ScrollScene({duration:1}).setPin("#trigger1"),s.on("enter leave",function(e){TweenLite.to($("#startBtn"),2,{opacity:"1"})}),pin=new ScrollScene({duration:800}).setPin("#part0"),c=new ScrollScene({offset:"200",duration:0}).setTween(a),p=new ScrollScene({offset:"200",duration:0}).setTween(i),f=new ScrollScene({offset:"200",duration:0}).setTween(l),d=new ScrollScene({offset:"210",duration:600}).setTween(tween4),c.on("end",function(e){TweenLite.to($("#startBtn"),.1,{opacity:"0"}),$("#instructions").removeAttr("style"),TweenLite.from($("#instructions"),2,{opacity:"0",top:vert,delay:4}),TweenMax.to($("#instructions"),1,{y:"10",yoyo:!0,repeat:-1})}),w.addScene([pin,s,c,p,f,d]),wingFlap(),loopClouds()}function loopClouds(){var e=$("#clouds1"),t=$("#clouds2");TweenMax.to(t,60,{left:vert,repeat:-1,yoyo:!0,ease:Linear.easeNone}),TweenMax.to(e,50,{css:{left:vert},repeat:-1,yoyo:!0,ease:Linear.easeNone})}function wingFlap(){var e=$("#part0-wing");e.css("opacity","1"),TweenMax.to($("#part0-wing"),.1,{opacity:"0",repeat:2,delay:rand(3,5),onComplete:wingFlap})}function initPart1(){var e,t,n,r,o,a,i,l;t=$("#part1-text1"),n=$("#part1-text2"),text3=$("#part1-text3"),e=new ScrollScene({triggerElement:"#trigger1",offset:vert/2,duration:1e3}).setPin("#part1"),e.addIndicators(),e.on("start",function(e){plasmodium()}),e.on("exit",function(e){$(".germs").removeAttr("style")}),r=TweenLite.from(t,1,{opacity:"0",y:"20"}),o=TweenLite.from(n,1,{opacity:"0",y:"20"}),tween3=TweenLite.from(text3,1,{opacity:"0",y:"20"}),a=new ScrollScene({triggerElement:"#trigger1",offset:vert/2,duration:0}).setTween(r),i=new ScrollScene({triggerElement:"#trigger1",offset:vert/2+200,duration:0}).setTween(o),l=new ScrollScene({triggerElement:"#trigger1",offset:vert/2+500,duration:0}).setTween(tween3),controller=new ScrollMagic,controller.addScene([e,a,i,l]),bloodFlow1(),bloodFlow2()}function bloodFlow1(){var e=$("#part1-blood");e.css("left",hori.toString()+"px"),TweenLite.from(e,10,{left:"-400px",ease:Linear.easeNone,onComplete:bloodFlow1})}function bloodFlow2(){var e=$("#part1-bloodinf");e.css("left",hori.toString()+"px"),TweenLite.from(e,15,{left:"-200px",onComplete:bloodFlow2,ease:Linear.easeNone})}function plasmodium(){var e=$("#part1-particles"),t=e.children(),n=new Array,r=e.height(),o=e.width(),a=$("#part1-flowL"),i=$("#part1-flowR");e.removeAttr("style"),$("img.germs").removeAttr("style"),$(".flow").removeAttr("style"),TweenLite.to($(".flow"),1,{opacity:"1"});for(var l=TweenLite.from(a,1,{top:"-200px",left:"-50px",ease:Linear.easeNone}),s=TweenLite.from(i,1,{top:"-200px",right:"-50px",ease:Linear.easeNone}),c=0;c<t.length;c++)TweenLite.to(t[c],4,{left:rand(0-2*o,2*o),top:rand(r,3*r),rotation:rand(-180,180),delay:.8}),0;TweenLite.to($(".germs"),15,{left:vert+200+"px",ease:Linear.easeNone,delay:1.8,opacity:"1"}),fixMaps()}function fixMaps(){$("#part2-world-map").resize(),$("#part2-world-map-cases").resize(),$("#part4-world-map").resize()}function rand(e,t){return Math.floor(Math.random()*(1+t-e)+e)}function initPart2(){function e(){n.css("display","none"),r.css("opacity","1")}var t,n,r,o,a,i,l,o,s,c,p,f,d,w,g,m,u,y;makePart2Map(),makePart2MapCases(),n=$("#part2-world-map"),r=$("#part2-world-map-cases"),s=$("#part2-emph1 span"),c=$("#part2-emph2 span"),a=$("#part2-emph1"),i=$("#part2-top-info p"),l=$("#part2-emph2"),o=$("#part2-text2"),p=TweenLite.from(a,1,{opacity:"0",y:"20",onStart:countUp,onStartParams:[97,s,2e3,0]}),f=TweenLite.from(i,1,{opacity:"0",y:"20",delay:2}),tween3=TweenLite.from(l,1,{opacity:"0",y:"20",onStart:countUp,onStartParams:[90,c,2e3,1]}),tween4=TweenLite.from(o,1,{opacity:"0",y:"20"}),d=TweenLite.to(n,.1,{opacity:"0",onComplete:e,delay:2.5}),t=new ScrollScene({triggerElement:"#trigger2",offset:vert/2,duration:1700}).setPin("#part2"),g=new ScrollScene({triggerElement:"#trigger2",offset:vert/2,duration:0}).setTween(p),m=new ScrollScene({triggerElement:"#trigger2",offset:vert/2,duration:0}).setTween(f),u=new ScrollScene({triggerElement:"#trigger2",offset:vert/2+500,duration:0}).setTween(tween3),space1=new ScrollScene({triggerElement:"#trigger2",offset:vert/2+500,duration:0}).setTween(d),y=new ScrollScene({triggerElement:"#trigger2",offset:vert/2+700,duration:0}).setTween(tween4),controller=new ScrollMagic,controller.addScene([t,g,m,u,space1,y]),space1.on("start",function(e){n.removeAttr("style"),r.removeAttr("style")}),fixMaps()}function makePart2Map(){$("#part2-world-map").vectorMap({map:"world_mill_en",backgroundColor:"transparent",zoomOnScroll:!1,regionStyle:{initial:{fill:"#4c4c4c"},hover:{fill:"#fba309"},selected:{fill:"#fba309"},selectedHover:{}},series:{regions:[{values:casesData,scale:["#9a0001","#9a0000"],normalizeFunction:"polynomial"}]},onRegionLabelShow:function(e,t,n){t.html(t.html())}}),$("#part2-world-map").append("<p>Data retrieved from the WHO 2013 World Malaria Report</p>"),$("#part2-mapTitle").text("Countries Affected by Malaria")}function makePart2MapCases(){$("#part2-world-map-cases").vectorMap({map:"world_mill_en",backgroundColor:"transparent",zoomOnScroll:!1,regionStyle:{initial:{fill:"#4c4c4c"},hover:{fill:"#fba309"},selected:{fill:"#fba309"},selectedHover:{}},series:{regions:[{values:casesData,scale:["#ffffff","#9a0000"],normalizeFunction:"polynomial"}]},onRegionLabelShow:function(e,t,n){t.html(t.html()+"<br/>Cases: "+formatNumber(casesData[n]))}})}function countUp(e,t,n,r){var o="";$({countNum:0}).animate({countNum:e},{duration:n,easing:"linear",step:function(){1==r&&(o="%"),t.text(Math.floor(this.countNum)+o)},complete:function(){t.text(this.countNum+o)}})}function initPart3(){var e,t,n,r,o,a,i,l,s,c,p,f,d,w,g,m;t=$("#part3-ITN"),n=$("#part3-IRS"),r=$("#part3-antiMed"),o=$("#part3-other"),a=$("#net"),i=$("#part3-mininet"),l=$("#part3-bed"),s=$("#part3-spraycan"),c=$("#part3-spraycloud"),g=TweenLite.to($("#part3-top"),2,{css:{backgroundColor:"#32394f"},ease:Linear.easeNone,delay:2}),m=TweenLite.to($("#part3"),2,{css:{backgroundColor:"#232439"},ease:Linear.easeNone,delay:2}),nightTween3=TweenLite.from($("#net"),2,{css:{backgroundColor:"rgba(112,112,112,0.46)"},ease:Linear.easeNone,delay:2}),d=TweenLite.to($("#net"),5,{"background-position-y":"-1300px",ease:Linear.easeNone}),w=TweenLite.to($("#net"),2,{opacity:"0"}),tween1=TweenLite.from(t,1,{opacity:"0",y:"20"}),tween2=TweenLite.from(n,1,{opacity:"0",y:"20"}),tween3=TweenLite.from(r,1,{opacity:"0",y:"20"}),tween4=TweenLite.from(o,1,{opacity:"0",y:"20"}),tweenMiniNet=TweenLite.from(i,3,{scaleY:.1,y:-300,opacity:"0",ease:Linear.easeNone}),tweenSprayCan=TweenLite.from(s,2,{y:20}),tweenSprayCloud=TweenMax.from(c,.5,{scaleY:.1,scaleX:.1,x:-25,y:-70,opacity:"0",ease:Linear.easeNone,delay:1,repeat:3}),e=new ScrollScene({triggerElement:"#trigger3",offset:vert/2,duration:3e3}).setPin("#part3"),scene1=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+150,duration:0}).setTween(g),scene2=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+150,duration:0}).setTween(m),scene2b=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+150,duration:0}).setTween(nightTween3),scene3=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+500,duration:800}).setTween(d),scene4=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+1e3,duration:300}).setTween(w),scene5=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+1400,duration:0}).setTween(tween1),scene6=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+1650,duration:250}).setTween(tweenMiniNet),scene7=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+2e3,duration:0}).setTween(tween2),scene8=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+2150,duration:50}).setTween(tweenSprayCan),scene9=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+2200,duration:100}).setTween(tweenSprayCloud),scene10=new ScrollScene({triggerElement:"#trigger3",offset:vert/2+2400,duration:0}).setTween(tween3),e.addIndicators(),controller=new ScrollMagic,controller.addScene([e,scene1,scene2,scene2b,scene3,scene4,scene5,scene6,scene7,scene8,scene9,scene10])}function initPart4(){makePart4Map();var e,t,n,r,o,a,i,r,l,s,c,p,f,d,w,g,m,u;e=new ScrollScene({triggerElement:"#trigger4",offset:vert/2,duration:500}).setPin("#part4"),controller=new ScrollMagic,controller.addScene([e])}function makePart4Map(){$("#part4-world-map").vectorMap({map:"world_mill_en",backgroundColor:"transparent",zoomOnScroll:!1,regionsSelectable:!0,regionsSelectableOne:!0,regionStyle:{initial:{fill:"#4c4c4c"},hover:{fill:"#fba309"},selected:{fill:"#fba309"},selectedHover:{}},series:{regions:[{values:casesData,scale:["#ffffff","#9a0000"],normalizeFunction:"polynomial"}]},onRegionLabelShow:function(e,t,n){t.html(t.html()+"<br/>Cases: "+formatNumber(casesData[n]))},onRegionSelected:function(e,t,n,r){var o=$("#part4-world-map").vectorMap("get","mapObject").getRegionName(t);null!=plot1?(plot1.destroy(),checkValidData(t)&&(plot1=makeBarGraph(itnData2012[t],irsData2012[t],antiMal2012[t],o))):checkValidData(t)&&(plot1=makeBarGraph(itnData2012[t],irsData2012[t],antiMal2012[t],o))}}),$("#part4-world-map").append("<p>Data retrieved from the WHO 2013 World Malaria Report</p>")}function formatNumber(e){e+="",x=e.split("."),x1=x[0],x2=x.length>1?"."+x[1]:"";for(var t=/(\d+)(\d{3})/;t.test(x1);)x1=x1.replace(t,"$1,$2");return x1+x2}function checkValidData(e){return"undefined"==typeof itnData2012[e]||"undefined"==typeof irsData2012[e]||"undefined"==typeof antiMal2012[e]?!1:!0}function makeBarGraph(e,t,n,r){var o,a,i;if(o=[e],a=[t],i=[n],-1==e){o=[" "];var l="(No Information Provided)"}else l=o+"%";if(-1==t){a=[" "];var s="(No Information Provided)"}else s=a+"%";if(0==n){i=[" "];var c="(No Information Provided)"}else c=i+"%";var p=[e,t,n],f=jQuery.jqplot("chart1",[p],{title:r+"'s Estimated Intervention/Prevention Coverage",seriesDefaults:{renderer:$.jqplot.BarRenderer,rendererOptions:{barPadding:8,barMargin:10,barDirection:"vertical",barWidth:50,shadowOffset:2,shadowDepth:5,shadowAlpha:.8}},series:[{pointLabels:{show:!0,labels:[l,s,c]}}],axesDefaults:{min:0,max:120},axes:{xaxis:{renderer:$.jqplot.CategoryAxisRenderer,ticks:[["Insectide Treated Nets"],["Indoor Residual Spraying"],["Antimalarial Coverage"]]},yaxis:{label:"% of population potentially protected",pad:1.05,labelOptions:{fontSize:"8pt"}}}});return f}function makePieGraph(e,t,n){var r,o,a,i,l,s;r=e,o=100-e,a=t,i=100-t,l=n,s=100-n;var c=[["Population potentially protected by ITNs",r],["Unprotected",o]],p=[["% IRS Coverage",a],["Unprotected",i]],f=[["AntiMalarial coverage",l],["Unprotected",s]],d=$.jqplot("chart1",[c,p,f],{seriesDefaults:{renderer:$.jqplot.DonutRenderer,rendererOptions:{sliceMargin:1,startAngle:-90,showDataLabels:!0}},legend:{show:!0,location:"e"}});return d}function initPart5(){var e=new Date;setInterval(function(){var t=Math.round((new Date-e)/1e3),n=Math.round(t/60/60),r=Math.floor(t/60%60),o=Math.floor(t%60%60);10>o&&(o="0"+o),n>0&&(n+=":"),$("#timer>h2").text(n+r+":"+o)},1e3)}var hori=$(window).width(),vert=$(window).height(),count=0;$(window).load(function(){$("#loader").fadeOut("slow"),$(".part").css("height",vert)}),$(document).ready(function(){function e(e){var t=$("#instructions-hint");t.removeAttr("style"),setTimeout(function(){e==$(window).scrollTop()&&800<$(window).scrollTop()&&TweenLite.to($("#instructions-hint"),1,{opacity:"1",bottom:"5px"},Linear.easeNone)},5e3)}$(window).scroll(function(){var e=$(this).scrollLeft(),t=$(this).scrollTop()});var t=0;$(window).scroll(function(){$(window).scrollTop()+$(window).height()!=$(document).height()&&(window.scroll=$(window).scrollTop(),e(window.scroll))}),initPart0(),initPart1(),initPart2(),initPart3(),initPart4(),initPart5()});var plot1=null;